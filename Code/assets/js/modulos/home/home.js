import { msgError,msgSuccess } from "../message.js";import {validateAsunto,validateName,validateEmail } from "../validation.js";if(  location.search == '' || location.search == '?c=All&m=index'){const btnOpenLoginModal=document.getElementById("btn-login");btnOpenLoginModal.addEventListener("click",()=>{const e=document.getElementById("nombre_usuario"),t=document.getElementById("password");e.value="",t.value=""});const validateFormLogin=(e,t)=>{if(""==e.value){e.focus(),msgError("Ingresar correo")}else if(1!=validateEmail(e.value)){t.focus(),msgError("El Correo ingresado no es valido")}else{if(""!=t.value)return!0;t.focus(),msgError("Ingresar clave")}},btnSubmitFormLogin=document.getElementById("loginBtn");btnSubmitFormLogin.addEventListener("click",e=>{e.preventDefault();const t=document.getElementById("nombre_usuario"),o=document.getElementById("password");if(1==validateFormLogin(t,o)){const e=new FormData;e.append("nombre_usuario",t.value),e.append("password",o.value),fetch("?c=Login&m=auth",{method:"POST",body:e}).then(e=>e.ok?Promise.resolve(e):Promise.reject(new Error("Error al Login"))).then(e=>e.json()).then(e=>{if(""==e){msgError("Datos incorrectos")}else if("incorrectoP"==e.error){o.focus(),msgError("ContraseÃ±a incorrecta")}else if("incorrectoU&P"==e.error){t.focus(),msgError("El usuario no existe")}else if("incorrectoUser"==e.error){t.focus(),msgError("El usuario esta deshabilitado contactese con un administrador")}else e.fk_rol?"1"==e.fk_rol?location.href="?c=Administradores&m=index":"2"==e.fk_rol&&(location.href="?c=Empleados&m=index"):location.href="?c=All&m=index"}).catch(console.log)}});const validateFormContact=(e,t,o,n,r,a)=>{if(""==e.value){e.focus(),msgError("Ingresar Nombre")}else if(1!=validateName(e.value)){e.focus(),msgError("El Nombre ingresado no es valido")}else if(""==t.value){t.focus(),msgError("Ingresar Apellido")}else if(""==validateName(t.value)){t.focus(),msgError("El Apellido ingresado no es valido")}else if(""==o.value){o.focus(),msgError("Ingresar Correo")}else if(""==validateEmail(o.value)){o.focus(),msgError("El Correo ingresado no es valido")}else if(""==n.value){n.focus(),msgError("Ingresar Asunto")}else if(""==validateAsunto(n.value)){n.focus(),msgError("El Asunto ingresado no es valido")}else if(""==r.value){r.focus(),msgError("Ingresar Mensaje")}else if(document.querySelector('input[name="genero_contact"]:checked')){if(document.querySelector('input[name="terminos_contact"]:checked'))return!0;a.focus(),msgError("Acepte los terminos y condiciones")}else{document.querySelector('input[name="genero_contact"]').focus(),msgError("Ingresar genero")}},btnSubmitFormContact=document.getElementById("form_contacto");btnSubmitFormContact.addEventListener("click",e=>{e.preventDefault();const t=document.getElementById("label_form_contacto"),o=document.getElementById("nombre_contact"),n=document.getElementById("apellido_contact"),r=document.getElementById("email_contact"),a=document.getElementById("asunto_contact"),s=document.getElementById("message_contact"),c=document.getElementById("terminos_contact");if(validateFormContact(o,n,r,a,s,c)){btnSubmitFormContact.setAttribute("disabled",""),t.textContent="Espere";const e=new FormData,l=document.querySelector('input[name="genero_contact"]:checked').value;e.append("nombre_contact",o.value),e.append("apellido_contact",n.value),e.append("email_contact",r.value),e.append("asunto_contact",a.value),e.append("message_contact",s.value),e.append("terminos_contact",c.value),e.append("genero_contact",l),fetch("?c=All&m=formContact",{method:"POST",body:e}).then(e=>e.ok?Promise.resolve(e):Promise.reject(new Error("Error al Login"))).then(e=>{if(e.ok){msgSuccess("Enviado Correctamente"),resetValueFormContact(o,n,r,a,s,c),btnSubmitFormContact.removeAttribute("disabled"),t.textContent="Enviar"}else{msgError("Error No se puedo enviar")}}).catch(console.log)}});const resetValueFormContact=(e,t,o,n,r,a)=>{e.value="",t.value="",o.value="",n.value="",r.value=""},noticiasRow=document.getElementById("noticias_row");noticiasRow.addEventListener("click",e=>{const t=e.target.getAttribute("data-id");t&&"noticia"==e.target.getAttribute("data-tipo")&&showModal("news",t)});const eventosRow=document.getElementById("eventos_row");eventosRow.addEventListener("click",e=>{const t=e.target.getAttribute("data-id");t&&"evento"==e.target.getAttribute("data-tipo")&&showModal("events",t)});const showModalEN=(e,t="news")=>{document.getElementById("showModal").textContent=`${"news"==t?"Noticias":"Eventos"}`,document.getElementById("show_title").textContent=`${e.title?e.title:""}`,document.getElementById("show_description").innerHTML=`${e.description?e.description:""}`,document.getElementById("show_date").textContent=`${e.name} ${e.lastname} ${e.updated_at}`,document.getElementById("show_prev_img").src=`${e.image?e.image:""}`},showModal=(e,t)=>{fetch(`?c=All&m=showModal&tabla=${e}&id=${t}`).then(e=>e.ok?Promise.resolve(e):Promise.reject(new Error("Fallo la consulta News"))).then(e=>e.json()).then(t=>{showModalEN(t,e)}).catch(console.log)};}